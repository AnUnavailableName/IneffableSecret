# CANScope学习

## 1. 节点测试文档学习

<center>2023年7月18日-CAN_tc.pdf</center>

---

* 对照合众的通讯测试标准及测试结果，标注CAN_Scope功能：

|   测试项   |                        测试用例                        |   测试结果   | CAN_Scope可承担 |
| :--------: | :----------------------------------------------------: | :----------: | :-------------: |
|   物理层   |                  [CASE#1]终端电阻测试                  |     PASS     |       [×]       |
|   物理层   |               [*CASE#2*]显性输出电压测试               |     PASS     |       [√]       |
|   物理层   |               [*CASE#3*]隐性输出电压测试               |     PASS     |       [√]       |
|   物理层   |            [*CASE#4*]隐性到显性边沿时间测试            |     PASS     |       [√]       |
|   物理层   |            [*CASE#5*]显性到隐性边沿时间测试            |     PASS     |       [√]       |
|   物理层   |                  [*CASE#6*]位时间测试                  |     PASS     |       [√]       |
|   物理层   |                  [*CASE#7*]采样点测试                  | 缺少测试环境 |       [√]       |
|   物理层   |                  [*CASE#8*]地偏移测试                  |   硬件相关   | [√]（程控电源） |
|   物理层   | [*CASE#9*]DUT电源**/**地线**/**CAN_H**/**CAN_L断路测试 |   硬件相关   |       [√]       |
|   物理层   |              [*CASE#10*]CAN_H对地短路测试              |   硬件相关   |       [√]       |
|   物理层   |             [*CASE#11*]CAN_H对电源短路测试             |   硬件相关   |       [√]       |
|   物理层   |              [*CASE#12*]CAN_L对地短路测试              |   硬件相关   |       [√]       |
|   物理层   |             [*CASE#13*]CAN_L对电源短路测试             |   硬件相关   |       [√]       |
|   物理层   |            [*CASE#14*]CAN_H与CAN_L短路测试             |   硬件相关   |       [√]       |
|   物理层   |              [*CASE#15*]通信电压范围测试               |   硬件相关   | [√]（程控电源） |
| 数据链路层 |                 [*CASE#16*]报文ID测试                  |   硬件相关   |       [√]       |
| 数据链路层 |                 [*CASE#17*]报文DLC测试                 |   硬件相关   |       [√]       |
| 数据链路层 |                [*CASE#18*]报文周期测试                 |   硬件相关   |       [√]       |
| 数据链路层 |                 [*CASE#19*]事件帧测试                  |   硬件相关   |       [×]       |
| 数据链路层 |               [*CASE#20*]周期事件帧测试                |   硬件相关   |       [×]       |
| 数据链路层 |               [*CASE#21*]负载率通信测试                | 缺少测试环境 |       [√]       |
|   应用层   |              [*CASE#22*]网络启动时间测试               | 缺少测试环境 |       [×]       |
|   应用层   |              [*CASE#23*]网络关闭时间测试               | 缺少测试环境 |       [×]       |
|   应用层   |            [*CASE#24*] Bus-off恢复策略测试             | 缺少测试环境 |       [√]       |

> ***手册中规定了大量可用测试项，基本覆盖了测试需求。但对于需要计时的测试，没有发现它有同步记录的触发接口，不知道是否需要手动计时。***

## 2. 网络故障排查文档学习

<center>2023年6月29日-CAN_res.pdf</center>

---

1. **CANScope主要功能**

   1. **超长的波形和报文存储，可进行存储后分析，复现错误。**
   2. 测试总线干扰。通过眼图、波形傅里叶分析等手段查找干扰源。
   3. 支持高层协议，仪表盘图形化仿真。
   4. 事件标记，记录关注的波形。

   【使用CANScope-StressZ扩展后的功能】

   1. 模拟干扰、终端工作状态模拟、错误模拟。包括物理层上进行短路、总线长度、总线负载和终端电阻匹配测试。
   2. 最佳波特率标定。测试导线在不同频率下的匹配电阻、寄生电容和电感。

2. **CANScope应用场景**

   1. 排查位定时异常节点
   2. 观测总线状态（帧错误率统计）、排查故障节点（按ID进行统计）
   3. 观测总线利用率、排查传输堵塞节点（流量分析定位ID）
   4. 排查干扰（FFT分析共模干扰）寻找干扰源
   5. 信号质量排查（眼图）
   6. 测量传输延时和信号线带宽（测量上升下降时间），匹配传输速率和距离
   7. 波形记录分析，软件眼图分析（直观查看故障波形，可查询数据源进行分析）
   8. 模拟总线阻抗、感抗和容抗对信号质量的影响
   9. 排查导致通讯介质异常的环境因素（导线长度、温度、电磁环境等）

3. **总结**  
	
   ​	CANScope在针对CAN网络系统进行错误排查有成熟的方案，它的示波器-报文模式和眼图对分析一些物理层的问题很有帮助。

